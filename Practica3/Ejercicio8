/* En un entrenamiento de fútbol hay 20 jugadores que forman 4 equipos (cada jugador conoce el equipo al cual pertenece llamando a la función DarEquipo()). 
Cuando un equipo está listo (han llegado los 5 jugadores que lo componen), debe enfrentarse a otro equipo que también esté listo 
(los dos primeros equipos en juntarse juegan en la cancha 1, y los otros dos equipos juegan en la cancha 2). 
Una vez que el equipo conoce la cancha en la que juega, sus jugadores se dirigen a ella. Cuando los 10 jugadores del 
 llegaron a la cancha comienza el partido, juegan durante 50 minutos, 
y al terminar todos los jugadores del partido se retiran (no es necesario que se esperen para salir). */

Process Jugador [id: 1..20] {
    int miEquipo = DarEquipo();
    int miCancha;

    Equipo[miEquipo].llegada(numeroC);
    Cancha[numeroC].llegada();
}

Process Partido[id: 1..2] {
    Cancha[id].iniciarPartido();
    Delay(90);
    Cancha[id].terminarPartido();
}

Monitor Equipo[id: 1..4] {
    int cantJugadores = 0;
    int numCancha;
    cond esperaEquipo;

    Procedure llegada(numeroC: out int){
        cantJugadores++;
        if(cantJugadores == 5){
            Admin.DarCancha(numCancha);
            signal(esperaEquipo);
        }
        else{
            wait(esperaEquipo);
        }
        cancha = numCancha;
    }

}

Monitor Admin {
    int cant = 0;
    Procedure DarCancha(numeroC: out int){
        cant++;
        if(cant <= 2){
            numeroC = 1;
        }
        else{
            numeroC = 2;
        }
    }
}

Monitor Cancha[id: 1..2] {
    int cantJugadores = 0;
    cond esperaPartido, inicioPartido;

    Procedure llegada(){
        cantJugadores++;
        if(cantJugadores == 10){
            signal(inicioPartido);
        }
        wait(esperaPartido);
    }

    Procedure iniciarPartido(){
        if(cantJugadores < 10){
            wait(inicioPartido);
        }
    }

    Procedure terminarPartido(){
        signal_all(esperaPartido);
    }

}